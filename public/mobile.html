<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don't Drink! - Mobile</title>
    <link rel="stylesheet" href="styles.css"> <!-- Assuming external CSS if any -->
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    
        
        
            
                Don't Drink!

                Room: LOADING

            


            
                Connecting to game server...

                Retry Connection
            

            
            
                
                    Your Name:
                    
                

                
                
                    Choose your avatar:
                    
                        🍆

                        🍑

                        💋

                        😈

                        🔥

                        💦

                        🌶️

                        🍌

                        🥵

                        😏

                        🕺

                        💃

                        👅

                        🤤

                        🍯

                        😎

                    

                

                
                Join Game
            

        


        
        
            
                Don't Drink!

                Room: 

            


            
                
                    🍆

                    Player Name

                

                
                
                    Successfully joined! Waiting for host to start game...
                

            

        


        
        

        

    


    
    <script>
        const socket = io(); // Assuming connects to server
        const roomCode = window.location.pathname.slice(1); // e.g. GLSJJ5
        document.querySelectorAll('header p')[1].textContent = `Room: ${roomCode}`; // Adjusted selector for "Room: "

        // Retry logic for connection (3 attempts)
        let connectAttempts = 0;
        const maxAttempts = 3;
        socket.on('connect_error', () => {
            connectAttempts++;
            if (connectAttempts >= maxAttempts) {
                alert('Connection failed after retries. Try again later.');
            } else {
                setTimeout(() => socket.connect(), 2000); // Retry after 2s
            }
        });

        // Avatar selection logic
        const avatarButtons = document.querySelectorAll('.avatar-button');
        avatarButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                avatarButtons.forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
            });
        });

        // Join game button
        document.getElementById('joinGameButton').addEventListener('click', () => {
            const playerName = document.getElementById('playerName').value.trim() || 'Player';
            const avatar = document.querySelector('.avatar-button.selected')?.textContent || '🍆'; // Fallback avatar
            socket.emit('join-room', { roomCode, playerName, avatar });

            // Handle success
            socket.on('joined-room', ({ success, player }) => {
                if (success) {
                    document.querySelector('.join-form').style.display = 'none';
                    document.querySelector('.waiting').style.display = 'block';
                    // Set dynamic name and avatar
                    document.querySelector('.waiting .avatar').textContent = player.avatar;
                    document.querySelector('.waiting .name').textContent = player.name;
                }
            });
        });

        // Error listener
        socket.on('error', (data) => {
            alert(data.message); // e.g. "Room not found"
        });

        // Retry button
        document.getElementById('retryButton').addEventListener('click', () => {
            socket.connect();
        });
    </script>
</body>
</html>